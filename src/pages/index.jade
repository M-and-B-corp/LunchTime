extends layout
include ../blocks/header/header
include ../blocks/button/button
include ../blocks/basket/basket
include ../blocks/order/order
include ../blocks/session/session
include ../blocks/menuitem/menuitem
include ../blocks/footer/footer
include ../blocks/subscriber/subscriber
include ../blocks/message/message

block title
    title Главная страница
block content
    if user
        +header(user)
        +button("+", ["button_new-order"],{'href': '/services/'})
    else
        +header()
    .main-wrapper
        .main-page
            -var orders2 = orders.splice(0,orders.length/2);
            .column
                each order in orders
                    +session(order)
            .column
                each order in orders2
                    +session(order)
        +footer('© M&B Corporation')

    if user
        #chat.chat
            .chat__content
                .chat__title
                    span.title__user_name= user.name
                    .chat__close
                        img(src="../images/total/close.png" onclick="document.getElementById('chat').style.display='none'")
                .chat__history
                form.chat__input
                    img(src=user.avatar)
                    .input_message
                        input.form-control(autocomplete='off' style="color: #777;" value="Введите Ваше сообщение.." onfocus="if (this.value == 'Введите Ваше сообщение..') {this.value = ''; this.style.color = '#000';}" onblur="if (this.value == '') {this.value = 'Введите Ваше сообщение..'; this.style.color = '#777';}")
                        +button("Отправить", ['button_size-m'], {"type": "submit"})

    #signIn.signIn
        .signIn__content
            .signIn__title
                span.title__user_name Авторизация
                .signIn__close
                    img(src="../images/total/close.png" onclick="document.getElementById('signIn').style.display='none'")
            .signIn__history
                .signIn__name Ваше имя
                .history__input
                    input(type="text" class="signIn__input" autocomplete='off' style="color: #777;" value="Введите имя" onfocus="if (this.value == 'Введите имя') {this.value = ''; this.style.color = '#000';}" onblur="if (this.value == '') {this.value = 'Введите имя'; this.style.color = '#777';}")
                .signIn__surname Ваша фамилия
                .history__input
                    input(type="text" class="signIn__input" autocomplete='off' style="color: #777;" value="Введите фамилию" onfocus="if (this.value == 'Введите фамилию') {this.value = ''; this.style.color = '#000';}" onblur="if (this.value == '') {this.value = 'Введите фамилию'; this.style.color = '#777';}")
                .signIn__button
                    +button("Войти", ['button_size-m'], {"type": "submit"})
                .signIn__or или
                .signIn__login войдите через
                    .login__sites
                        a.auth__social.auth__social_vk(href="/auth/vk")
                        a.auth__social.auth__social_fb(href="/auth/fb")

    if user
        each order in orders
            if user.name === order.owner.name
                #orderform.orderform
                    .orderform__content
                        .chat__title
                            .order_title Форма заказа
                            .chat__close
                                img(src="../images/total/close.png" onclick="document.getElementById('orderform').style.display='none'")
                        .orderform__contact
                            .info-content__phone
                                .field
                                    .phone__title Имя
                                    input(type="text" class="phone__number" autocomplete='off' style="color: #777;" value="Имя" onfocus="if (this.value == 'Имя') {this.value = ''; this.style.color = '#000';}" onblur="if (this.value == '') {this.value = 'Имя'; this.style.color = '#777';}")
                                hr.info__hr
                                .field
                                    .phone__title Фамилия
                                    input(type="text" class="phone__number" autocomplete='off' style="color: #777;" value="Фамилия" onfocus="if (this.value == 'Фамилия') {this.value = ''; this.style.color = '#000';}" onblur="if (this.value == '') {this.value = 'Фамилия'; this.style.color = '#777';}")
                                hr.info__hr
                                .field
                                    .phone__title Телефон
                                    input(type="text" class="phone__number" autocomplete='off' style="color: #777;" value="Телефон" onfocus="if (this.value == 'Телефон') {this.value = ''; this.style.color = '#000';}" onblur="if (this.value == '') {this.value = 'Телефон'; this.style.color = '#777';}")
                                hr.info__hr
                                .field
                                    .phone__title Оператор
                                    input(type="text" class="phone__operator" autocomplete='off' style="color: #777;" value="Оператор" onfocus="if (this.value == 'Оператор') {this.value = ''; this.style.color = '#000';}" onblur="if (this.value == '') {this.value = 'Оператор'; this.style.color = '#777';}")
                                hr.info__hr
                                .field
                                    .adress__title Улица
                                    input(type="text" class="adress__adress" autocomplete='off' style="color: #777;" value="Улица" onfocus="if (this.value == 'Улица') {this.value = ''; this.style.color = '#000';}" onblur="if (this.value == '') {this.value = 'Улица'; this.style.color = '#777';}")
                                hr.info__hr
                                .field
                                    .adress__title Дом
                                    input(type="text" class="adress__adress" autocomplete='off' style="color: #777;" value="Дом" onfocus="if (this.value == 'Дом') {this.value = ''; this.style.color = '#000';}" onblur="if (this.value == '') {this.value = 'Дом'; this.style.color = '#777';}")
                                hr.info__hr
                                .field
                                    .adress__title Корпус
                                    input(type="text" class="adress__adress" autocomplete='off' style="color: #777;" value="Корпус" onfocus="if (this.value == 'Корпус') {this.value = ''; this.style.color = '#000';}" onblur="if (this.value == '') {this.value = 'Корпус'; this.style.color = '#777';}")
                                hr.info__hr
                                .field
                                    .adress__title Квартира
                                    input(type="text" class="adress__adress" autocomplete='off' style="color: #777;" value="Квартира" onfocus="if (this.value == 'Квартира') {this.value = ''; this.style.color = '#000';}" onblur="if (this.value == '') {this.value = 'Квартира'; this.style.color = '#777';}")
                                hr.info__hr
                        .orderform__dishes
                            each zakaz in order.orders
                                +eda(zakaz.dish.title, zakaz.count, zakaz.dish.price)
                            each subscriber in order.subscribers
                                each subDish in subscriber.orders
                                    .photo(data-title=subDish.title)
                                        img(src=subDish.image)
                        .orderform__input
                            .input__button
                                +button("Заказать", [], {"type": "submit"})
    if user
        script.
            var mainUser = !{JSON.stringify(user)};
        script
            include scripts/chat.js
    script
        include scripts/signIn.js
        include scripts/removeSession.js
        include scripts/removeSubscriber.js

