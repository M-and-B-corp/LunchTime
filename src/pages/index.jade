extends ../views/layout/layout
include ../blocks/header/header
include ../blocks/button/button
include ../blocks/basket/basket
include ../blocks/order/order
include ../blocks/session/session
include ../blocks/menuitem/menuitem
include ../blocks/footer/footer
include ../blocks/group/group
include ../blocks/subscriber/subscriber


block title
    title Главная страница
    if user
        +header(user)
        +button("Создать новый заказ", [".button_new-order"],{'href': '/services?owner=True' })
    else
        +header()
    script
        include ../blocks/total/total.js
    .main-wrapper
        .main-page
            each order in orders
                form(action="/mymenu", method="post")
                    input(type="hidden", name="orderId" value='#{order._id}')
                    input(type="hidden", name="serviceId" value='#{order.service._id}')
                    +session(order.owner.name, order.time, order.service.logo, order.service._id)
                    if user
                        if order.owner.name===user.name
                            script.
                                timer(document.getElementById('time').innerHTML);
                    each subscriber in order.subscriber
                        +subscriber(subscriber.person.name, subscriber.dishes, subscriber)
        +footer("Заказывайте еду на нашей стороне, на темной стороне...")
        button.total__button(onclick="document.getElementById('block').style.display='block'") Total

    //#total.total
        .total__close(onclick="document.getElementById('total').style.display='none'")
        .total__content
            .total__title Итого
            +group(
            'Супы', [
                {title_dish: 'Блюдо 1', link: 'http://www.pizzatempo.by/menu/obed.html', quantity: '3', price: '170'},
                {title_dish: 'Блюдо 1', link: 'http://www.pizzatempo.by/menu/obed.html', quantity: '3', price: '170'}]
            )
            +group(
            'Супы', [
                {title_dish: 'Блюдо 1', link: 'http://www.pizzatempo.by/menu/obed.html', quantity: '3', price: '170'},
                {title_dish: 'Блюдо 1', link: 'http://www.pizzatempo.by/menu/obed.html', quantity: '3', price: '170'}]
            )
            +group(
            'Супы', [
                {title_dish: 'Блюдо 1', link: 'http://www.pizzatempo.by/menu/obed.html', quantity: '3', price: '170'},
                {title_dish: 'Блюдо 1', link: 'http://www.pizzatempo.by/menu/obed.html', quantity: '3', price: '170'}]
            )
            +group(
            'Супы', [
                {title_dish: 'Блюдо 1', link: 'http://www.pizzatempo.by/menu/obed.html', quantity: '3', price: '170'},
                {title_dish: 'Блюдо 1', link: 'http://www.pizzatempo.by/menu/obed.html', quantity: '3', price: '170'}]
            )

